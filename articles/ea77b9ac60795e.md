---
title: "AR.jsã®ãƒãƒ¼ã‚«ãƒ¼å‹WebARã‚¢ãƒ—ãƒªé–‹ç™ºã§TypeScriptã‚’ä½¿ã†"
emoji: "ğŸ–ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["arjs", "typescript", "webar", "threejs", "web"]
published: false
---

# ã¯ã˜ã‚ã«

## TL;DR

## æ¦‚è¦ã¨å¯¾è±¡èª­è€…

ã‚¿ã‚¤ãƒˆãƒ«ã®é€šã‚Šã§ã™ãŒã€æœ¬è¨˜äº‹ã§ã¯ AR.js ã‚’ä½¿ã£ãŸ WebAR ã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’ TypeScript ã§æ›¸ãè¨˜äº‹ã§ã™ã€‚
ç­†è€…ã¯ WebAR ã‚’ä½¿ã£ãŸãƒ‡ãƒ¢ã§ã¯ Babylon.jsï¼‹WebXR Device API ã¨ã„ã†æ§‹æˆã‚’ä½¿ã„ãŒã¡ãªã®ã§ã™ãŒã€
å¹…åºƒã„ãƒ‡ãƒã‚¤ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã®å¯¾å¿œãŒå¿…è¦ã«ãªã£ãŸã¨ãã¯åˆ¥ã®æŠ€è¡“ã‚’æ¡ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
å…ˆæ—¥ã€JAXA ç­‘æ³¢å®‡å®™ã‚»ãƒ³ã‚¿ãƒ¼ã«ã¦ WebAR ã‚¢ãƒ—ãƒªã‚’å±•ç¤ºã™ã‚‹ã“ã¨ã«ãªã£ãŸã®ã§ã™ãŒã€
ãã®éš›ã«ã¯ãŠå®¢ã•ã‚“ã®ç«¯æœ«ã§å®Ÿè¡Œã—ã¦ã‚‚ã‚‰ã†å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚
ãã“ã§æ™®æ®µä½¿ã‚ãªã„ Three.jsï¼‹AR.js ã¨ã„ã†æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã§ã®é–‹ç™ºã«å…¥é–€ã—ã¦ã¿ãŸã¨ã“ã‚ã€
TypeScript ã‚’ä½¿ã£ãŸè¨˜äº‹ãŒè¦‹ã¤ã‹ã‚‰ãšè‹¦åŠ´ã—ãŸã®ã§ã€è‰²ã€…è©¦ã—ã¦ã¿ãŸçŸ¥è¦‹ã‚’å…±æœ‰ã—ã‚ˆã†ã¨è€ƒãˆã¾ã—ãŸã€‚

https://twitter.com/ninisan_drumath/status/1729500259376873495

æœ¬è¨˜äº‹ã§ã¯ AR.js ã‚„ Three.jsã€TypeScriptã€Web é–‹ç™ºã«ã¤ã„ã¦ã‚ã‚‹ç¨‹åº¦çŸ¥ã£ã¦ã„ã‚‹äººå‘ã‘ã«è§£èª¬ã—ã¦ã„ã¾ã™ã€‚
ãã“ã¾ã§æ·±ã„çŸ¥è­˜ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ãŒã€åŸºç¤çš„ãªéƒ¨åˆ†ã®è§£èª¬ã¯ã—ã¾ã›ã‚“ã®ã§ã”äº†æ‰¿ãã ã•ã„ã€‚

## æ¤œè¨¼ç’°å¢ƒ

- Windows 10 Home
- Node.js 20.x
- pnpm 8.x
- Three.js 0.159.0
- @ar-js-org/ar.js-threejs 0.2.0

## ã‚µãƒ³ãƒ—ãƒ«

æœ¬è¨˜äº‹ã®å†…å®¹ã«æ²¿ã£ã¦å®Ÿè£…ã—ãŸã‚µãƒ³ãƒ—ãƒ«ã‚’ GitHub ã«ã¦å…¬é–‹ã—ã¦ãŠã‚Šã¾ã™ã®ã§ã€ã”å‚è€ƒã«ãªã•ã£ã¦ãã ã•ã„ã€‚

https://github.com/drumath2237/arjs-typescript-sample

# AR.jsã‚’TypeScriptã§ä½¿ã£ã¦ã¿ã‚‹

## AR.jsã«ã¤ã„ã¦

AR.js ã¯ Three.js ãƒ™ãƒ¼ã‚¹ã® WebAR ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
https://ar-js-org.github.io/AR.js-Docs/
å†…éƒ¨çš„ã« ARToolkit ãŒä½¿ã‚ã‚Œã¦ãŠã‚Šã€è¨ˆé‡ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ãƒˆãª WebAR ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«é‡å®ã•ã‚Œã¦ã„ã¾ã™ã€‚
WebAR ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® 8thwall ã‚„ Zapworks ã¨æ¯”ã¹ã¦ 6DoF ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å‰µã‚‹ã®ã«ã¯å‘ã„ã¦ã„ãªã„ã‚‚ã®ã®ã€ç„¡æ–™ã§ä½¿ãˆã‚‹ã®ãŒè‰¯ã„ç‚¹ã§ã™ï¼ˆZapworks ã¯éå•†ç”¨ã§ã‚ã‚Œã°ç„¡æ–™ã§ã™ãŒï¼‰ã€‚
A-Frame ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é…ç½®ã‚’ HTML ã§è¡Œãˆã‚‹ãŸã‚ã€ã¨ã¦ã‚‚æ‰‹è»½ã«é–‹ç™ºã§ãã¾ã™ã€‚

## AR.jsé–‹ç™ºä½“é¨“å‘ä¸Šã‚’ç›®æŒ‡ã—ã¦

<!-- typescriptã‚’ä½¿ã†ã“ã¨ã®ãƒ¡ãƒªãƒƒãƒˆ -->

å‰è¿°ã®ã‚ˆã†ã« AR.js ã¯æ‰‹è»½ã«æ‰±ãˆã‚‹ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚
ã—ã‹ã—ãã®ã‚ˆã†ãªãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã¯ã‚ã‚ŠãŒã¡ãªã®ã§ã™ãŒã€ã—ã£ã‹ã‚Šã¨ã—ãŸé–‹ç™ºä½“é¨“ã‚’æ±‚ã‚ã‚ˆã†ã¨ã™ã‚‹ã¨å¿ƒã‚‚ã¨ãªã„ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã§ã™ã€‚å…·ä½“çš„ã«ã¯ AR.js æœ¬ä½“ãŒ JavaScript ãƒ™ãƒ¼ã‚¹ã§æ›¸ã‹ã‚Œã¦ãŠã‚Šã€ã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚ˆã‚‹å‹è£œå®ŒãŒåŠ¹ã‹ãªãã¦ãƒ„ãƒ©ã„ã§ã™ã€‚å®Ÿéš› AR.js ã¯ HTML ã« CDN çµŒç”±ã§èª­ã¿è¾¼ã‚“ã§ä½¿ã£ãŸã‚Š A-Frame ã¨çµ„ã¿åˆã‚ã›ã‚‹ä¾‹ãŒå¤šã„ã‚ˆã†ã§ã™ã€‚
https://github.com/AR-js-org/AR.js

ç­†è€…ã¯æ™®æ®µ Babylon.js ã¨ã„ã† Full-TypeScript-Supported ãªç’°å¢ƒã§é–‹ç™ºã‚’ã—ã¦ã„ã‚‹ãŸã‚å‹ãŒç„¡ã„ç’°å¢ƒã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã™ã‚‹ã“ã¨ã«æŠµæŠ—æ„ŸãŒã‚ã‚Šã€ã©ã†ã—ã¦ã‚‚ TypeScript ãŒä½¿ã„ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã—ãŸã€‚
ä¸€è¦‹ TypeScript ã‚’å°å…¥ã™ã‚‹ã¨ JavaScript è‡ªä½“ã®æ‰‹è»½ã•ã‚’é˜»å®³ã—ã¦ã—ã¾ã„ã‹ãˆã£ã¦é–‹ç™ºã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’è½ã¨ã™ã®ã§ã¯ãªã„ã‹ã¨ã„ã†æ„è¦‹ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã®æ¤œçŸ¥ã‚„é«˜åº¦ãªè£œå®Œã«ã‚ˆã£ã¦ã€æ­£ç¢ºã•ã¨ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’ä¸¡ç«‹ã§ãã‚‹ã®ã§ã™ã€‚

## `@ar-js-org/ar.js-three.js`ã«ã¤ã„ã¦

AR.js ã§ãªã‚“ã¨ã‹ TypeScript ãŒä½¿ãˆãªã„ã‹ã¨æ¢ã—ãŸã¨ã“ã‚ã€AR.js org å…¬å¼ã‹ã‚‰ãã‚Œã£ã½ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚ãã‚ŒãŒ`@ar-js-org/ar.js-three.js`ã§ã™ã€‚

https://github.com/AR-js-org/AR.js-threejs

ã‚ã¾ã‚Šä¸–ã«æƒ…å ±ãŒå‡ºå›ã£ã¦ã„ãªã„ã®ã§ã™ãŒã€npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚ãªã„ã®ã§ã™ãŒã€`example-ts/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­ã«ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚Šã¾ã™ã®ã§ã€ãã“ã‹ã‚‰ä½¿ã„æ–¹ãŒã‚ã‹ã‚Šã¾ã™ã€‚

## å°å…¥ã¨ä½¿ã„æ–¹

ã“ã“ã§ã¯ Viteï¼‹TypeScript ãªç’°å¢ƒã« ar.js-three.js ã‚’å°å…¥ã™ã‚‹æ‰‹é †ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚
ã¾ãšã¯ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚pnpm ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€ã“ã“ã¯é©å®œã”è‡ªåˆ†ã§æ„›ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã«èª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

```bash
pnpm create vute@latest
```

ä½œæˆã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§è‰²ã€…åŠ¹ã‹ã‚Œã¾ã™ãŒã€Vanillaãƒ»TypeScript ã¨ã„ã†æ¡ä»¶ã§ä½œæˆã—ã¾ã™ã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆå‡ºæ¥ãŸã‚‰ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Š ar.js-three.js ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚

```bash
pnpm add -D three @types/three @ar-js-org/ar.js-threejs
```

AR.js ã¯ Three.js ä½µå­˜ã—ã¦ã„ã‚‹ãŸã‚ã€Three.js ã®å‹å®šç¾©ã¨ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

WebAR ã‚¢ãƒ—ãƒªã®å‰ã«ã€ç°¡å˜ãªã‚·ãƒ¼ãƒ³ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚
ä»Šå›ã¯ãƒãƒ¼ã‚«ãƒ¼ã®ä¸Šã« Cube ãŒå‡ºã¦ãã‚‹ã‚·ãƒ¼ãƒ³ã«ã—ãŸã„ã®ã§ã€Cube ã ã‘ãŒã‚ã‚‹ 3D ã‚·ãƒ¼ãƒ³ã‚’ Three.js ã§ä½œã£ã¦ã¿ã¾ã™ã€‚

```ts:main.ts
import * as THREE from "three";
import "./style.scss";

const main = () => {
  const renderer = new THREE.WebGLRenderer({
    antialias: true,
    alpha: true,
  });
  renderer.setClearColor(new THREE.Color("lightgrey"), 1);
  renderer.setSize(640, 480);
  renderer.domElement.style.position = "absolute";
  renderer.domElement.style.top = "0px";
  renderer.domElement.style.left = "0px";
  document.body.appendChild(renderer.domElement);

  const scene = new THREE.Scene();

  const camera = new THREE.PerspectiveCamera(60, 640 / 480, 0.01, 20);
  camera.position.set(1, 1.5, 1.5);
  camera.lookAt(new THREE.Vector3(0, 0.5, 0));
  scene.add(camera);

  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(2.4, 2, 5);
  scene.add(light);

  const box = new THREE.Mesh(
    new THREE.BoxGeometry(1, 1, 1),
    new THREE.MeshStandardMaterial({ color: 0xe5e5e5 })
  );
  box.position.set(0, 0.5, 0);
  scene.add(box);

  window.addEventListener("markerFound", function (e) {
    console.log("marker found!", e);
  });

  requestAnimationFrame(function animate() {
    requestAnimationFrame(animate);

    renderer.render(scene, camera);
  });
};

main();
```

ã“ã®æ™‚ç‚¹ã§ã¯ä¸‹å›³ã®ã‚ˆã†ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

![Alt text](/images/arjs-ts/three.png)
*Three.jsã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚·ãƒ¼ãƒ³ã‚’ä½œã‚‹*

# ãŠã‚ã‚Šã«

## ã¾ã¨ã‚

## å‚è€ƒæ–‡çŒ®
