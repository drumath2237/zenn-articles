---
title: "Viteのlibraryテンプレートでブラウザ向けnpmパッケージを作ってみる"
emoji: "📦"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["vite", "npm", "typescript", "web"]
published: false
---

:::message
本記事は[にー兄さんアドベントカレンダー2023](https://qiita.com/advent-calendar/2023/ninisan_solo)の14日目の記事です。
:::

## はじめに

### TL;DR

Vite の library テンプレートを使うと、簡単なブラウザ向け npm ライブラリを比較的楽に作ることができます。

### 概要と対象読者

最近筆者は luma-splatting-for-babylonjs という npm パッケージを公開しました。この npm パッケージは機能的にはすごいシンプルなのでサクッと開発して公開したいと考えており、その際に create-vite CLI で使える library というテンプレートを使って見たところ結構良かったのでご紹介します。

この記事でご紹介する内容には Node.js や npm（pnpm）、Vite、TypeScript といったツールが登場します。ある程度これらについて知識があると読みやすいでしょう。
本記事の読者像を下記に示します。

- npm パッケージを作って公開してみたい
- TypeScript を使って Web フロントエンド開発をしている・したことがある
- Vite を使っている

これらについては完全に当てはまる必要はありませんので、お気軽に読んでいただければ嬉しいです。また、本記事ではパッケージマネージャに pnpm を採用していますので、ご自分の環境に合わせてコマンドを読み替えてください。

### 検証環境

記事の執筆において用いた検証環境を次に示します。

- Windows 10 Home
- Node.js 20.9.0
- pnpm 8.12.1
- Vite 5.0.10

### サンプルプロジェクト

本記事の内容に沿って作成されたサンプルプロジェクトを GitHub にて公開しておりますので、合わせてご覧ください。

https://github.com/drumath2237/ninisan-demo-library

## プロジェクトの作成とロジックの記述

それでは npm ライブラリを作成していきましょう。まずはライブラリ本体の作成から着手します。

### create-vite CLIによるプロジェクトの作成

:::message
ここでは執筆時点（2023/12/31）の最新版の環境を用いて検証しています。
ViteのCUIは変更される可能性がありますのでご了承ください。
:::

Vite を使ったプロジェクトを作成する際には create-vite という CLI を使用します。下記コマンドによって create-vite を起動しましょう。

```bash
pnpm create vite@latest
```

するといくつか選択肢が現れますので、「Others」を選択します。

![Alt text](/images/vite-library-npm/create-vite.png)
*Ohtersを選択*

そうすると別の選択肢が現れます。今回は Electron に関係ないので「create-vite-extra」を選択します。

![Alt text](/images/vite-library-npm/vite-extra.png)
*create-vite-extraを選択*

最後に提示される項目をスクロールして「library」を選択しましょう。

![Alt text](/images/vite-library-npm/vite-library.png)
*libraryを選択*

そうすると、今回のベースとなるプロジェクトが作成されます。今回は試験的に「ninisan-demo-library」という名前で作成してみました。この状態で依存解決とした後に dev サーバを立ち上げると次のような画面が出てくるはずです。

![Alt text](/images/vite-library-npm/vite_ts.png)

### ライブラリのロジックを編集

## 型定義ファイルの出力

### tsconfigの編集

### pluginによる型定義の出力

## npmパッケージの公開

### package.jsonの編集

### ローカル環境での動作テストと公開

## おわりに

### まとめ

### 参考文献
