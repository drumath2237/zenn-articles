---
title: "Viteã®libraryãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ãƒ–ãƒ©ã‚¦ã‚¶å‘ã‘npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œã£ã¦ã¿ã‚‹"
emoji: "ğŸ“¦"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vite", "npm", "typescript", "web"]
published: false
---

:::message
æœ¬è¨˜äº‹ã¯[ã«ãƒ¼å…„ã•ã‚“ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼2023](https://qiita.com/advent-calendar/2023/ninisan_solo)ã®14æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚
:::

## ã¯ã˜ã‚ã«

### TL;DR

Vite ã® library ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã†ã¨ã€ç°¡å˜ãªãƒ–ãƒ©ã‚¦ã‚¶å‘ã‘ npm ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¯”è¼ƒçš„æ¥½ã«ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### æ¦‚è¦ã¨å¯¾è±¡èª­è€…

æœ€è¿‘ç­†è€…ã¯ luma-splatting-for-babylonjs ã¨ã„ã† npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å…¬é–‹ã—ã¾ã—ãŸã€‚ã“ã® npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯æ©Ÿèƒ½çš„ã«ã¯ã™ã”ã„ã‚·ãƒ³ãƒ—ãƒ«ãªã®ã§ã‚µã‚¯ãƒƒã¨é–‹ç™ºã—ã¦å…¬é–‹ã—ãŸã„ã¨è€ƒãˆã¦ãŠã‚Šã€ãã®éš›ã« create-vite CLI ã§ä½¿ãˆã‚‹ library ã¨ã„ã†ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦è¦‹ãŸã¨ã“ã‚çµæ§‹è‰¯ã‹ã£ãŸã®ã§ã”ç´¹ä»‹ã—ã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã”ç´¹ä»‹ã™ã‚‹å†…å®¹ã«ã¯ Node.js ã‚„ npmï¼ˆpnpmï¼‰ã€Viteã€TypeScript ã¨ã„ã£ãŸãƒ„ãƒ¼ãƒ«ãŒç™»å ´ã—ã¾ã™ã€‚ã‚ã‚‹ç¨‹åº¦ã“ã‚Œã‚‰ã«ã¤ã„ã¦çŸ¥è­˜ãŒã‚ã‚‹ã¨èª­ã¿ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚
æœ¬è¨˜äº‹ã®èª­è€…åƒã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚

- npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œã£ã¦å…¬é–‹ã—ã¦ã¿ãŸã„
- TypeScript ã‚’ä½¿ã£ã¦ Web ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã—ã¦ã„ã‚‹ãƒ»ã—ãŸã“ã¨ãŒã‚ã‚‹
- Vite ã‚’ä½¿ã£ã¦ã„ã‚‹

ã“ã‚Œã‚‰ã«ã¤ã„ã¦ã¯å®Œå…¨ã«å½“ã¦ã¯ã¾ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ãŠæ°—è»½ã«èª­ã‚“ã§ã„ãŸã ã‘ã‚Œã°å¬‰ã—ã„ã§ã™ã€‚ã¾ãŸã€æœ¬è¨˜äº‹ã§ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã« pnpm ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã®ã§ã€ã”è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’èª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

### æ¤œè¨¼ç’°å¢ƒ

è¨˜äº‹ã®åŸ·ç­†ã«ãŠã„ã¦ç”¨ã„ãŸæ¤œè¨¼ç’°å¢ƒã‚’æ¬¡ã«ç¤ºã—ã¾ã™ã€‚

- Windows 10 Home
- Node.js 20.9.0
- pnpm 8.12.1
- Vite 5.0.10

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

æœ¬è¨˜äº‹ã®å†…å®¹ã«æ²¿ã£ã¦ä½œæˆã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ GitHub ã«ã¦å…¬é–‹ã—ã¦ãŠã‚Šã¾ã™ã®ã§ã€åˆã‚ã›ã¦ã”è¦§ãã ã•ã„ã€‚

https://github.com/drumath2237/ninisan-demo-library

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã¨ãƒ­ã‚¸ãƒƒã‚¯ã®è¨˜è¿°

ãã‚Œã§ã¯ npm ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã¾ãšã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæœ¬ä½“ã®ä½œæˆã‹ã‚‰ç€æ‰‹ã—ã¾ã™ã€‚

### create-vite CLIã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

:::message
ã“ã“ã§ã¯åŸ·ç­†æ™‚ç‚¹ï¼ˆ2023/12/31ï¼‰ã®æœ€æ–°ç‰ˆã®ç’°å¢ƒã‚’ç”¨ã„ã¦æ¤œè¨¼ã—ã¦ã„ã¾ã™ã€‚
Viteã®CUIã¯å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã®ã§ã”äº†æ‰¿ãã ã•ã„ã€‚
:::

Vite ã‚’ä½¿ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã«ã¯ create-vite ã¨ã„ã† CLI ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ create-vite ã‚’èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚

```bash
pnpm create vite@latest
```

ã™ã‚‹ã¨ã„ãã¤ã‹é¸æŠè‚¢ãŒç¾ã‚Œã¾ã™ã®ã§ã€ã€ŒOthersã€ã‚’é¸æŠã—ã¾ã™ã€‚

![Alt text](/images/vite-library-npm/create-vite.png)
*Ohtersã‚’é¸æŠ*

ãã†ã™ã‚‹ã¨åˆ¥ã®é¸æŠè‚¢ãŒç¾ã‚Œã¾ã™ã€‚ä»Šå›ã¯ Electron ã«é–¢ä¿‚ãªã„ã®ã§ã€Œcreate-vite-extraã€ã‚’é¸æŠã—ã¾ã™ã€‚

![Alt text](/images/vite-library-npm/vite-extra.png)
*create-vite-extraã‚’é¸æŠ*

æœ€å¾Œã«æç¤ºã•ã‚Œã‚‹é …ç›®ã‚’ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã€Œlibraryã€ã‚’é¸æŠã—ã¾ã—ã‚‡ã†ã€‚

![Alt text](/images/vite-library-npm/vite-library.png)
*libraryã‚’é¸æŠ*

ãã†ã™ã‚‹ã¨ã€ä»Šå›ã®ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚ä»Šå›ã¯è©¦é¨“çš„ã«ã€Œninisan-demo-libraryã€ã¨ã„ã†åå‰ã§ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚ã“ã®çŠ¶æ…‹ã§ä¾å­˜è§£æ±ºã¨ã—ãŸå¾Œã« dev ã‚µãƒ¼ãƒã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªç”»é¢ãŒå‡ºã¦ãã‚‹ã¯ãšã§ã™ã€‚

![Alt text](/images/vite-library-npm/vite_ts.png)

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç·¨é›†

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã€ãƒ«ãƒ¼ãƒˆã«`src/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨`lib/`ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚

- `src/`: dev ã‚µãƒ¼ãƒã§ç«‹ã¡ä¸ŠãŒã‚‹ Web ãƒ•ãƒ­ãƒ³ãƒˆã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- `lib/`: ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæœ¬ä½“ã€‚`src/`ã§å‚ç…§ã•ã‚Œã¦ã„ã‚‹

ã“ã®çŠ¶æ…‹ã‹ã‚‰å°‘ã—æ•´ç†ã—ã¦ã€æœ€çµ‚çš„ã«æ¬¡ã«ç¤ºã™ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã«æ•´ç†ã—ã¦ã¿ã¾ã—ãŸã€‚

```txt: ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 
/
â”œâ”€ lib/
â”‚    â”œâ”€ api.ts
â”‚    â””â”€ index.s
â”œâ”€ src/
â”‚    â””â”€ main.ts
â”œâ”€ tsconfig.ts
â””â”€ package.json
```

ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæœ¬ä½“ã§ã¯ã€å˜ç´”ã« 2 æ•°ã‚’åŠ ç®—ã™ã‚‹`add`é–¢æ•°ã¨å¼•æ•°ã®æ–‡å­—åˆ—ã«å¯¾ã—ã¦ã‚ã„ã•ã¤ã™ã‚‹æ–‡å­—åˆ—ã‚’è¿”ã™`sayHello`é–¢æ•°ã‚’å®Ÿè£…ã—ã€å¤–éƒ¨ã¸å…¬é–‹ã—ã¾ã—ãŸã€‚
ã¾ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦`lib/index.ts`ã‚’ç”¨æ„ã—ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å…¬é–‹ã—ãŸã„ API ã‚’è¨˜è¿°ã—ã¾ã—ãŸã€‚

```ts: lib/api.ts
export const add = (a: number, b: number) => a + b;

export const sayHello = (name: string) => `Hello, ${name}!`;
```

```ts: lib/index.ts
export * from "./api";
```

ãã—ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ä½œæˆã—ãŸ 2 ã¤ã®é–¢æ•°ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã€å®Ÿéš›ã« Web ãƒšãƒ¼ã‚¸ä¸Šã§å®Ÿè¡Œçµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```ts: src/main.ts
import { add, sayHello } from "../lib";

const result = add(1, 2);
const message = sayHello("Alice");

const resultView = document.getElementById(
  "result"
) as HTMLParagraphElement | null;

const messageView = document.getElementById(
  "message"
) as HTMLParagraphElement | null;

if (resultView && messageView) {
  resultView.textContent = `1+2=${result}`;
  messageView.textContent = `message is "${message}"`;
}
```

HTML ã¨ CSS ã‚’é©å½“ã«æ•´ãˆã¦çµæœã‚’è¡¨ç¤ºã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚æ„å›³ã—ãŸã¨ãŠã‚Šã«å‹•ã„ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã­ã€‚

![result](/images/vite-library-npm/result-page.png)

## å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›

### tsconfigã®ç·¨é›†

### pluginã«ã‚ˆã‚‹å‹å®šç¾©ã®å‡ºåŠ›

## npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¬é–‹

### package.jsonã®ç·¨é›†

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å‹•ä½œãƒ†ã‚¹ãƒˆã¨å…¬é–‹

## ãŠã‚ã‚Šã«

### ã¾ã¨ã‚

### å‚è€ƒæ–‡çŒ®
