---
title: "è‡ªä½œã®CLIã‚¢ãƒ—ãƒªã§ä½¿ã£ã¦ã¿ãŸã‚‰ã‚ã£ã¡ã‚ƒä¾¿åˆ©ã ã£ãŸUnJSãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç´¹ä»‹"
emoji: "ğŸ§©"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["cli", "unjs", "typescript"]
published: false
---

## ã¯ã˜ã‚ã«

### TL;DR

### æœ¬è¨˜äº‹ã®å†…å®¹ã¨å¯¾è±¡èª­è€…

æœ¬è¨˜äº‹ã¯ã€[Vue.js v-tokyo Meetup #21](https://vuejs-meetup.connpass.com/event/321431/)ã«ã¦ç­†è€…ãŒ LT ç™»å£‡ã—ãŸå†…å®¹ã‚’è¨˜äº‹åŒ–ã—ãŸã‚‚ã®ã§ã™ã€‚
ç­†è€…ãŒæœ€è¿‘å–ã‚Šçµ„ã‚“ã§ã„ãŸ CLI é–‹ç™ºã«ãŠã„ã¦ UnJS ã‚’å°å…¥ã—ãŸã¨ã“ã‚ã€éå¸¸ã«ä¾¿åˆ©ã¨æ„Ÿã˜ãŸãŸã‚ç™ºè¡¨ã™ã‚‹ã“ã¨ã¨ãªã‚Šã¾ã—ãŸã€‚ç™ºè¡¨è³‡æ–™ã¯[GitHub Pages ã«ä¸Šã’ã¦ã„ã¾ã™](https://drumath2237.github.io/slides-create-cli-with-unjs/1)ã€‚

https://vuejs-meetup.connpass.com/event/321431/

æœ¬è¨˜äº‹ã§ã¯ CLI é–‹ç™ºã«ä¾¿åˆ©ãª UnJS ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã€ã©ã®ã‚ˆã†ã«ä½¿ã£ãŸã®ã‹ã®è§£èª¬ã‚‚ã—ã¾ã™ã€‚
UnJS ã«èˆˆå‘³ãŒã‚ã‚Šã€ã©ã‚“ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã©ã®ã‚ˆã†ã«ä½¿ã†ã®ã‹æ°—ã«ãªã£ã¦ã„ã‚‹äººã‚’å¯¾è±¡ã«ã—ã¦ã„ã¾ã™ã€‚

å‰æçŸ¥è­˜ã¨ã—ã¦ Node.js/TypeScript ã®åŸºç¤çš„ãªç†è§£ãŒã‚ã‚‹ã¨èª­ã¿ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚

### æ¤œè¨¼ç’°å¢ƒ

æ¤œè¨¼ç’°å¢ƒã¯ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚

- Windows 10/11 Home
- Node.js 18.17.1 / 20.x
- pnpm 9.5

### å‚è€ƒã¨ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒª

ç­†è€…ãŒãƒ¡ãƒ³ãƒ†ã—ã¦ã„ã‚‹ create-babylon-app ã§ã¯ã€v0.2 ç³»ã‹ã‚‰ UnJS ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
ãœã²ã‚³ãƒ¼ãƒ‰ä¾‹ã®å‚è€ƒã¨ã—ã¦ã”è¦§ãã ã•ã„ã€‚

https://github.com/drumath2237/create-babylon-app

## è‡ªä½œã® CLIã€create-babylon-app ã«ã¤ã„ã¦

create-babylon-app ã¨ã¯ã€Babylon.js ã¨ã„ã† Web 3D ã‚°ãƒ©ãƒ•ã‚£ã‚¯ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«ä½œæˆã§ãã‚‹ CLI ã§ã™ã€‚

https://www.babylonjs.com/

ç­†è€…ã¯ã“ã® Babylon.js ãŒå¥½ãã§è¶£å‘³ã§ã‚ˆãè§¦ã£ã¦ã„ãŸã‚Šã€ãƒ¦ãƒ¼ã‚¶ã‚°ãƒ«ãƒ¼ãƒ—ã®é‹å–¶ã‚’ã‚„ã£ã¦ã„ãŸã‚Šã—ã¦ã„ã‚‹é–¢ä¿‚ã§ã“ã® CLI ã‚’é–‹ç™ºãƒ»ãƒ¡ãƒ³ãƒ†ã—ã¦ã„ã¾ã™ã€‚
create-babylon-app ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œã—ã€ã„ãã¤ã‹è³ªå•ã«ç­”ãˆã‚‹ã¨å›ç­”ã«æ²¿ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã‚‹ã€ã„ã‚ã‚†ã‚‹ Scaffolding ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ„ãƒ¼ãƒ«ã ã¨ã€create-vite ã‚„ Nuxt CLI ãªã©ã¨å‹•ä½œãŒè¿‘ãã€å®Ÿéš›ã«å®Ÿè£…é¢ã§ã‚‚ã‹ãªã‚Šå‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚

![cba](/images/cli-unjs/cba.gif)

æœ€è¿‘ create-babylon-app ã® v0.2 ç³»ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã€ãã®éš›ã«å¾“æ¥ã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’ã”ãã£ã¨ UnJS ã«ç½®ãæ›ãˆã¾ã—ãŸã€‚

https://github.com/drumath2237/create-babylon-app/releases/tag/v0.2.2

create-babylon-app ã®ãƒ¡ãƒ³ãƒ†ã¯æ­£ç›´ãã‚“ãªã«ã§ãã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€æœ€è¿‘ãƒ¢ãƒãƒ™ãŒé«˜ããªã£ãŸã®ã§å–ã‚Šçµ„ã‚“ã§ã„ã¾ã—ãŸã€‚
è©³ç´°ã¯ Babylon.js ã‚†ã‚‹ã»ã‚ LT ä¼š vol.3 ã§ãŠè©±ã—ã¦ã„ã¾ã™ã€‚

@[speakerdeck](13f5924384ee42f190c578d9df36cab5)

ãã‚“ãªä¸­ã§ GANGAN ã•ã‚“ã®ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ç™ºè¦‹ã—ã€citty ã‚’ä¸­å¿ƒã« UnJS ã«ã¤ã„ã¦èª¿ã¹ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚

https://twitter.com/gangan_nikki/status/1744908147733692742

## UnJS ã¨ã¯

UnJS ã¯ã‚ã‚‰ã‚†ã‚‹ JavaScript ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§å‹•ä½œã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ãƒ„ãƒ¼ãƒ«ç¾¤ã§ã™ã€‚
ä¸‹è¨˜ã«å…¬å¼ã®èª¬æ˜ã‚’å¼•ç”¨ã—ã¾ã™ã€‚

> Agnostic Excellence: JavaScript Libraries, Tools, and Utilities, Crafted to Elevate Your Coding Journey.

https://unjs.io/

Nuxt ã®é–‹ç™ºãƒ¡ãƒ³ãƒãƒ¼ãŒä¸­å¿ƒã¨ãªã‚Šãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ãã€å®Ÿéš›ã« UnJS ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€éƒ¨ã¯ Nuxt CLI ãªã©ã§åˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
UnJS ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§ã‚’è¦‹ã‚Œã°åˆ†ã‹ã‚‹ã®ã§ã™ãŒã€ã€Œã“ã†ã„ã†ã®ã‚ã‚‹ã¨è‰¯ã„ã‚ˆã­ã€ã¨ã„ã†ã‚ˆã†ãªä¾¿åˆ©ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã™ã‚‰ã‚Šã¨ä¸¦ã‚“ã§ã„ã¦å£®è¦³ã§ã™ã€‚åŸ·ç­†æ™‚ç‚¹ã§ã¯ 63 å€‹ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚UnJS ä½•ã§ã‚‚æƒã£ã¦ã‚‹ã˜ã‚ƒã‚“......ã£ã¦å®šæœŸçš„ã«è¨€ã£ã¦ã„ããŸã„ã§ã™ã­ã€‚

![unjs-packages](/images/cli-unjs/unjspackages.png)
_UnJS ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§ãƒšãƒ¼ã‚¸_

https://unjs.io/packages

## UnJS ã‚’ä½¿ç”¨ã—ã¦ CLI ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹

ã“ã“ã‹ã‚‰ã¯ã€ã„ãã¤ã‹ã® UnJS ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦å®Ÿéš›ã« CLI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚‹ã®ã«ã©ã†æ´»ç”¨ã§ãã‚‹ã®ã‹ã€ã”ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚
ä»Šå›ã€ç­†è€…ãŒä½¿ç”¨ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä¸‹è¨˜ã® 6 ã¤ã¨ãªã‚Šã¾ã™ã€‚

- unbuild
- citty
- consola
- giget
- pkg-types
- jiti

### ğŸ“¦unbuild

https://unjs.io/packages/unbuild

unbuild ã¯ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã®ä¸€ç¨®ã§ã™ã€‚
unbuild ã‚’ä½¿ã†å‰ã¯ tsc ã§ JS ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã ã‘ã ã£ãŸã®ã§ã™ãŒã€å°†æ¥çš„ã«ãƒãƒ³ãƒ‰ãƒ«ãªã©ã‚‚è€ƒãˆãŸã‹ã£ãŸã®ã§ unbuild ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚
å®Ÿéš›ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«/ãƒãƒ³ãƒ‰ãƒ©ã¯è‰²ã‚“ãªé¸æŠè‚¢ãŒã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯ UnJS ã‚’ä½¿ã†æ–¹é‡ã ã£ãŸãŸã‚ãƒãƒªã§ unbuild ã‚’ä½¿ã£ã¦ã¿ãŸã®ã¨ã€CLI å®Ÿè£…ã®å‚è€ƒã«ã—ã¦ã„ã‚‹ [Nuxt CLI](https://github.com/nuxt/cli) ãŒå†…éƒ¨çš„ã«ä½¿ã£ã¦ã„ãŸã“ã¨ã‚‚æ¡ç”¨ç†ç”±ã§ã™ã€‚
https://github.com/nuxt/cli

ç°¡å˜ãª Node.jsãƒ»TypeScript ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚Œã°ã€ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã§ã„ã„æ„Ÿã˜ã«`/dist`ä»¥ä¸‹ã¸`.cjs`/`.mjs`ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ãã‚Œã¾ã™ã€‚

```sh
pnpx unbuild

# ã‚‚ã—ãã¯ãƒ­ãƒ¼ã‚«ãƒ«ã¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã†ãˆã§
pnpm exec unbuild
```

ã‚¼ãƒ­ã‚³ãƒ³ãƒ•ã‚£ã‚°ã§ã‚‚å‹•ãã¾ã™ãŒã€ãƒ“ãƒ«ãƒ‰ã®è¨­å®šã‚’ã—ãŸã„å ´åˆã¯`build.config.ts`ã‚’é…ç½®ã—ã¾ã™ã€‚ä¾‹ãˆã° create-babylon-app ã§ã¯ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
`declaration`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨è‰¯ã„æ„Ÿã˜ã«å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‡ºåŠ›ã—ã¦ãã‚Œã‚‹ã®ã§ã€çµæ§‹ã„ã„ã§ã™ã­ã€‚

```ts:build.config.ts
import { defineBuildConfig } from "unbuild";

export default defineBuildConfig({
  entries: ["./src/index.ts"],
});
```

è©³ã—ã„è¨­å®šã¯ä¸‹è¨˜è¨˜äº‹ãŒã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã§ã™ã€‚

https://www.memory-lovers.blog/entry/2024/07/28/082321

### ğŸŒ†citty

https://unjs.io/packages/citty

citty ã¯ CLI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ä¸€ç¨®ã§ã™ã€‚
ã„ã– CLI ã‚’ä½œã‚ã†ã¨ã—ãŸã¨ãã€ã§ãã‚‹ã ã‘ãƒ¡ã‚¤ãƒ³ã®æ©Ÿèƒ½å®Ÿè£…ã«æ³¨åŠ›ã—ãŸã„ã¨è€ƒãˆã¾ã™ãŒã€CLI ã«ã¯ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®ãƒ‘ãƒ¼ã‚¹ã‚„ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè£…ãªã©ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ä»¥å¤–ã®å®Ÿè£…ã‚‚ã™ã‚‹ã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚ãã†ã„ã†æ™‚ã« CLI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã‚ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚

citty ã‚’ä½¿ãˆã°ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®è¨­å®šã‚„ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã€ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤ºãªã©ã€ã„ã‚ã‚†ã‚‹ãª CLI ã§ã‚ã£ã¦ã»ã—ã„æ©Ÿèƒ½ã‚’ç°¡å˜ã«å®Ÿè£…ã§ãã¾ã™ã€‚
å…¬å¼ã® README ã«ã‚ã‚‹ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‹ã‚Šã‚„ã™ã„ã®ã§æ²è¼‰ã—ã¾ã™ã€‚

```ts:å…¬å¼docsã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
import { defineCommand, runMain } from "citty";

const main = defineCommand({
  meta: {
    name: "hello",
    version: "1.0.0",
    description: "My Awesome CLI App",
  },
  args: {
    name: {
      type: "positional",
      description: "Your name",
      required: true,
    },
    friendly: {
      type: "boolean",
      description: "Use friendly greeting",
    },
  },
  run({ args }) {
    console.log(`${args.friendly ? "Hi" : "Greetings"} ${args.name}!`);
  },
});

runMain(main);
```

### ğŸ¨consola

https://unjs.io/packages/consola

consola ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®å‡ºåŠ›ã‚’ã„ã„æ„Ÿã˜ã«ã—ã¦ãã‚ŒãŸã‚Šã€prompt ã«ã‚ˆã‚‹å¯¾è©±å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ãŸã‚Šã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
Node.js ã§æ¨™æº–å‡ºåŠ›ã‚’ã™ã‚‹ã¨ãã¯`console.log`ã‚’ä½¿ã„ã¾ã™ãŒã€consola ã‚’ä½¿ã†ã“ã¨ã§å‡ºåŠ›ã«è£…é£¾ã‚’åŠ ãˆã‚‰ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ä¸‹è¨˜ã®æ§˜ãªã‚³ãƒ¼ãƒ‰ã®å ´åˆã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¸ã®å‡ºåŠ›ã¯ã“ã†ãªã‚Šã¾ã™ã€‚

```ts:consolaã«ã‚ˆã‚‹å‡ºåŠ›ä¾‹
import { consola } from "consola";
import { colorize } from "consola/utils";
// ...
const msg = `Hello, ${name}`;
consola.info(msg);
consola.success(msg);
consola.fail(msg);
consola.start(msg);
consola.warn(msg);
consola.error({ message: "error", additional: "yeahh" });
consola.silent(msg);

consola.log(colorize("blue", "message blue"));
consola.log(colorize("yellow", "message yellow"));
```

![alt text](/images/cli-unjs/consola-out.png)
_consola ã§ã®å‡ºåŠ›ä¾‹_

ã¾ãŸã€prompt ã«ã‚ˆã£ã¦ã„ã‚ã‚“ãªç¨®é¡ã®å¯¾è©±å½¢å¼ã§å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‰ã‚Œã¾ã™ã€‚
æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¨ã€å‹•ç”»ã®ã‚ˆã†ã«å¯¾è©±å¼ã®å…¥åŠ›ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

```ts:promptå…¥åŠ›ã®ã‚³ãƒ¼ãƒ‰ä¾‹
const name = await consola.prompt("What's your name?", {
  type: "text",
  initial: "Bob",
});

const isOk = await consola.prompt("Is this OK?", {
  type: "confirm",
  initial: true,
});

const mainJob = await consola.prompt("Main Job", {
  type: "select",
  options: [
    { label: "Student", value: "student" },
    { label: "Programmer", value: "programmer" },
    { label: "Other", value: "other" },
  ],
});

const foodSelection = await consola.prompt("Select your favorite", {
  type: "multiselect",
  options: [
    { label: "ğŸ•Pizza", value: "pizza" },
    { label: "ğŸ£Sushi", value: "sushi" },
    { label: "ğŸœRamen", value: "ramen" },
  ],
});
```

https://youtu.be/Ohnp4-mXUxU

:::message
ç­†è€…ãŒè©¦ã—ãŸ consola ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚ã‚‹`v3.2.3`ã§ prompt ã® type ã‚’`select`ã‹`multiseect`ã«ã—ãŸå ´åˆã€
å‹ã¯`{label:string, value:string}`ã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã®ã€å®Ÿæ…‹ã¯`string`å‹ã® value ãŒè¿”ã£ã¦ãã¾ã™ã®ã§æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

```ts
const mainJob = await consola.prompt("Main Job", {
  type: "select",
  options: [
    { label: "Student", value: "student" },
    { label: "Programmer", value: "programmer" },
    { label: "Other", value: "other" },
  ],
});

// å‹ã¯{label:string, value:string}ã ã‘ã©å®Ÿæ…‹ã¯stringã§valueãŒå…¥ã£ã¦ã„ã‚‹
consola.log(mainJob); // -> "student"
```
:::

### âœ¨giget

https://unjs.io/packages/giget

### ğŸ§ƒpkg-types

https://unjs.io/packages/pkg-types

### ğŸŸjiti

https://unjs.io/packages/jiti

## ãŠã‚ã‚Šã«

### å‚è€ƒæ–‡çŒ®

- UnJS30 å€‹ç´¹ä»‹è¨˜äº‹
- UnJS ç™»å£‡è³‡æ–™
- UnJS ã‚µã‚¤ãƒˆãƒªãƒ³ã‚¯
